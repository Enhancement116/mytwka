<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="utf-8" />
    <title>Taiwan CNY Trip 2026</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Poppins', sans-serif; -webkit-tap-highlight-color: transparent; }
        .font-serif-tc { font-family: 'Noto Serif TC', serif; }
        
        /* èƒŒæ™¯ç´‹ç† */
        .pattern-bg {
            background-color: #7f1d1d;
            background-image: radial-gradient(#991b1b 1px, transparent 1px), radial-gradient(#991b1b 1px, transparent 1px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
        }

        /* æ²è»¸ç¾åŒ– */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #fca5a5; }
        ::-webkit-scrollbar-thumb { background: #b91c1c; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #991b1b; }

        /* å‹•ç•« */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn { animation: fadeIn 0.6s cubic-bezier(0.22, 1, 0.36, 1) forwards; }
    </style>
</head>
<body class="bg-red-950 text-white h-screen overflow-hidden flex flex-col pattern-bg font-sans">

    <!-- æ‡‰ç”¨ç¨‹å¼æ›è¼‰é» -->
    <div id="app" class="flex flex-col h-full"></div>

    <script>
        // ==========================================
        // 1. è³‡æ–™å­˜å„² (State & Data)
        // ==========================================
        const AppState = {
            currentView: 'home', // 'home' | 'itinerary' | 'preparation' | 'admin'
            currentDayIndex: 0,
            luckyDraw: {
                openedIndex: null,
                currentFortune: null
            },
            adminClickCount: 0,
            adminClickTimer: null
        };

        // åˆå§‹è¡Œç¨‹è³‡æ–™ (ä¾†è‡ª trip.store.ts)
        let TripData = {
            title: "å°ç£æ–°æ˜¥ä¹‹æ—… 2026",
            days: [
                {
                    dayNumber: 1,
                    theme: "æŠµé” & è¥¿é–€ç”º",
                    highlights: "æ­¡è¿ä¾†åˆ°å°ç£ï¼ç¬¬ä¸€å¤©è¼•é¬†ç‚ºä¸»ï¼Œé©æ‡‰æ°£å€™ï¼Œäº«å—è¡—é ­ç¾é£Ÿã€‚",
                    imgUrl: "ximending",
                    activities: [
                        { time: "14:00", title: "æŠµé”æ¡ƒåœ’æ©Ÿå ´", description: "æ­ä¹˜æ©Ÿå ´æ·é‹ç›´é”å°åŒ—è»Šç«™ (ç´„40åˆ†é˜)ã€‚è³¼è²·æ‚ éŠå¡èˆ‡SIMå¡ã€‚", location: "æ¡ƒåœ’æ©Ÿå ´ (TPE)", icon: "âœˆï¸" },
                        { time: "16:00", title: "é£¯åº—è¾¦ç†å…¥ä½", description: "å‰å¾€è¥¿é–€ç”ºé£¯åº—è¾¦ç†å…¥ä½ï¼Œç¨ä½œä¼‘æ¯ï¼Œæ•´ç†è¡Œæã€‚", location: "è¥¿é–€ç”º", icon: "ğŸ¨" },
                        { time: "18:00", title: "æ¢ç´¢è¥¿é–€ç”º", description: "å‰å¾€è¥¿é–€ç”ºå¾’æ­¥å€ï¼Œé«”é©—å°ç£å¹´è¼•äººçš„æ´»åŠ›èˆ‡ç†±é¬§æ°›åœã€‚", location: "è¥¿é–€ç”º", icon: "ğŸ›ï¸" },
                        { time: "19:00", title: "æ™šé¤ï¼šè¡—é ­å°åƒ", description: "æ¨è–¦ï¼šé˜¿å®—éºµç·šã€è±ªå¤§å¤§é›æ’ã€è€å¤©ç¥¿æ»·å‘³ (é©åˆç•¶å®µå¤œ)ã€‚", location: "è¥¿é–€ç”ºå•†åœˆ", icon: "ğŸœ" }
                    ]
                },
                {
                    dayNumber: 2,
                    theme: "è€å°åŒ—å¹´å‘³",
                    highlights: "æ„Ÿå—è¿ªåŒ–è¡—çš„ç†±é¬§å¹´è²¨å¤§è¡—ï¼Œé«”é©—å‚³çµ±å°ç£æ–°å¹´çš„æ°£æ°›ã€‚",
                    imgUrl: "dihua street",
                    activities: [
                        { time: "09:30", title: "ä¸­æ­£ç´€å¿µå ‚", description: "åƒè§€è‡ªç”±å»£å ´èˆ‡è¡›å…µäº¤æ¥å„€å¼ï¼Œæ‹ç…§ç•™å¿µã€‚", location: "è‡ªç”±å»£å ´", icon: "ğŸ›ï¸" },
                        { time: "11:30", title: "åˆé¤ï¼šé¼æ³°è±", description: "å“åšä¸–ç•Œèåçš„å°ç± åŒ… (å»ºè­°ææ—©æŠ½è™Ÿç¢¼ç‰Œ)ã€‚", location: "ä¿¡ç¾©è·¯/å—è¥¿åº—", icon: "ğŸ¥Ÿ" },
                        { time: "14:00", title: "è¿ªåŒ–è¡—å¹´è²¨å¤§è¡—", description: "æ„Ÿå—æœ€æ¿ƒåšçš„å¹´å‘³ï¼Œè©¦åƒç³–æœã€è²·ä¼´æ‰‹ç¦®ï¼Œåƒæ‹œéœæµ·åŸéšå»Ÿã€‚", location: "å¤§ç¨»åŸ•", icon: "ğŸ§§" },
                        { time: "18:00", title: "å¯§å¤å¤œå¸‚", description: "ç±³å…¶æ—å¿…æ¯”ç™»æ¨è–¦å¤œå¸‚ï¼Œå¿…åƒï¼šåœ“ç’°é‚Šèšµä»”ç…ã€åŠ‰èŠ‹ä»”è›‹é»ƒèŠ‹é¤…ã€‚", location: "å¯§å¤è·¯", icon: "ğŸ¢" }
                    ]
                },
                {
                    dayNumber: 3,
                    theme: "ä¹ä»½æ”¾å¤©ç‡ˆ",
                    highlights: "å‰å¾€å±±åŸä¹ä»½ï¼Œå‚æ™šåœ¨å¹³æºªæ”¾å¤©ç‡ˆç¥ˆç¦ï¼Œè¨±ä¸‹æ–°å¹´é¡˜æœ›ã€‚",
                    imgUrl: "jiufen",
                    activities: [
                        { time: "10:00", title: "å‰å¾€ä¹ä»½è€è¡—", description: "æ­ä¹˜åŒ…è»Šæˆ–å®¢é‹å‰å¾€ç‘èŠ³ä¹ä»½ã€‚", location: "ç‘èŠ³", icon: "ğŸš•" },
                        { time: "11:30", title: "ä¹ä»½è€è¡—èŒ¶æ¨“", description: "åœ¨é˜¿å¦¹èŒ¶æ¨“å“èŒ¶ï¼Œæ¬£è³å±±æµ·ç¾æ™¯ï¼Œå“åšèŠ‹åœ“ã€‚", location: "ä¹ä»½", icon: "ğŸµ" },
                        { time: "15:30", title: "ååˆ†ç€‘å¸ƒ", description: "è™Ÿç¨±å°ç£çš„å°¼åŠ æ‹‰ç€‘å¸ƒï¼Œå£¯è§€è¿·äººã€‚", location: "ååˆ†", icon: "ğŸŒŠ" },
                        { time: "17:30", title: "å¹³æºªæ”¾å¤©ç‡ˆ", description: "å¯«ä¸‹å…¨å®¶äººçš„æ–°å¹´é¡˜æœ›ï¼Œçœ‹å¤©ç‡ˆå†‰å†‰å‡ç©ºã€‚Huat Ah!", location: "å¹³æºª/ååˆ†", icon: "ğŸ®" }
                    ]
                },
                {
                    dayNumber: 4,
                    theme: "ç¾ä»£å°åŒ— & è³¼ç‰©",
                    highlights: "ç™»ä¸Šå°åŒ—101ï¼Œä¿¡ç¾©å€è³¼ç‰©ï¼Œç‚ºå®¶äººè³¼ç½®æ–°è¡£æ–°é‹ã€‚",
                    imgUrl: "taipei 101",
                    activities: [
                        { time: "10:30", title: "å°åŒ— 101 è§€æ™¯å°", description: "å¾ 89 æ¨“ä¿¯ç°å°åŒ—å¸‚æ™¯ï¼Œåƒè§€é¢¨é˜»å°¼çƒã€‚", location: "å°åŒ— 101", icon: "ğŸ™ï¸" },
                        { time: "13:00", title: "ä¿¡ç¾©å€å•†åœˆ", description: "æ–°å…‰ä¸‰è¶Šã€å¾®é¢¨å—å±±é€›è¡—è³¼ç‰©ã€‚æ„Ÿå—æ–°å¹´è£é£¾ã€‚", location: "ä¿¡ç¾©å€", icon: "ğŸ›ï¸" },
                        { time: "16:00", title: "æ¾å±±æ–‡å‰µåœ’å€", description: "é€›é€›èª å“ç”Ÿæ´»ï¼Œæ¬£è³æ–‡å‰µå•†å“èˆ‡å±•è¦½ã€‚", location: "æ¾è¸", icon: "ğŸ¨" },
                        { time: "19:00", title: "é¥’æ²³è¡—å¤œå¸‚", description: "ç¦å·ä¸–ç¥–èƒ¡æ¤’é¤…ã€è—¥ç‡‰æ’éª¨ã€‚åƒæ‹œæ…ˆç¥å®®ã€‚", location: "é¥’æ²³è¡—", icon: "ğŸ‰" }
                    ]
                },
                {
                    dayNumber: 5,
                    theme: "æº«æ³‰èˆ‡æ·¡æ°´å¤•é™½",
                    highlights: "å‰å¾€åŒ—æŠ•æ³¡æ¹¯æ”¾é¬†èº«å¿ƒï¼Œä¸‹åˆåˆ°æ·¡æ°´æ¬£è³ç¾éº—å¤•é™½ã€‚",
                    imgUrl: "beitou hot spring",
                    activities: [
                        { time: "10:00", title: "åŒ—æŠ•æº«æ³‰åšç‰©é¤¨", description: "åƒè§€æ—¥å¼å»ºç¯‰ï¼Œäº†è§£æº«æ³‰æ­·å²ï¼Œé™„è¿‘æœ‰åœ°ç†±è°·ã€‚", location: "æ–°åŒ—æŠ•", icon: "â™¨ï¸" },
                        { time: "12:00", title: "åˆé¤ï¼šæº«æ³‰æ‹‰éºµ", description: "äº«ç”¨ç†±é¨°é¨°çš„æ»¿ä¾†æº«æ³‰æ‹‰éºµã€‚", location: "æ–°åŒ—æŠ•", icon: "ğŸœ" },
                        { time: "14:30", title: "æ·¡æ°´è€è¡—", description: "æ­æ·é‹è‡³æ·¡æ°´ï¼Œå“åšé˜¿çµ¦ã€é­šé…¥ï¼Œé€›é€›æ²³å²¸å•†åº—ã€‚", location: "æ·¡æ°´", icon: "ğŸš¢" },
                        { time: "17:00", title: "æ¼äººç¢¼é ­å¤•é™½", description: "åœ¨æƒ…äººæ©‹æ¬£è³è½æ—¥ç¾æ™¯ï¼Œäº«å—æµ·é¢¨å¹æ‹‚ã€‚", location: "æ¼äººç¢¼é ­", icon: "ğŸŒ…" }
                    ]
                },
                {
                    dayNumber: 6,
                    theme: "ä¼´æ‰‹ç¦® & è¿”ç¨‹",
                    highlights: "æ¡è²·é³³æ¢¨é…¥ã€ç‰›è»‹ç³–ç­‰ä¼´æ‰‹ç¦®ï¼Œå¸¶è‘—æ»¿æ»¿å›æ†¶å›å®¶ã€‚",
                    imgUrl: "taiwan souvenirs",
                    activities: [
                        { time: "10:00", title: "ä½³å¾·/å¾®ç†±å±±ä¸˜", description: "è³¼è²·çŸ¥åçš„é³³æ¢¨é…¥ç•¶ä½œä¼´æ‰‹ç¦®é€çµ¦è¦ªæœ‹å¥½å‹ã€‚", location: "æ¾å±±å€", icon: "ğŸ" },
                        { time: "12:00", title: "æœ€å¾Œåˆé¤", description: "äº«ç”¨é“åœ°çš„å°å¼ç‰›è‚‰éºµï¼Œç‚ºæ—…ç¨‹ç•«ä¸‹å¥é»ã€‚", location: "å°åŒ—å¸‚å€", icon: "ğŸ¥¢" },
                        { time: "14:00", title: "å‰å¾€æ©Ÿå ´", description: "æ­ä¹˜æ©Ÿå ´æ·é‹æˆ–åŒ…è»Šå‰å¾€æ¡ƒåœ’æ©Ÿå ´ã€‚", location: "å°åŒ—è»Šç«™", icon: "ğŸš•" },
                        { time: "16:00", title: "æ­æ©Ÿè¿”é¦¬", description: "å¹³å®‰å›å®¶ï¼ŒæœŸå¾…ä¸‹æ¬¡å†ä¾†å°ç£ç©ï¼", location: "æ¡ƒåœ’æ©Ÿå ´", icon: "âœˆï¸" }
                    ]
                }
            ]
        };

        const Fortunes = [
            { title: "å¤§å‰å¤§åˆ©", desc: "ä»Šå¤©å»å“ªè£¡éƒ½é †åˆ©ï¼è¨˜å¾—å¤šæ‹å¹¾å¼µå…¨å®¶ç¦ã€‚" },
            { title: "è²¡æºæ»¾æ»¾", desc: "ç©¿ç´…è‰²è¡£æœå‡ºé–€ï¼Œæœƒé‡åˆ°å¥½äº‹å–”ï¼å¤œå¸‚åƒé£½é£½ã€‚" },
            { title: "å¹³å®‰å–œæ¨‚", desc: "æ”¾æ…¢è…³æ­¥ï¼Œäº«å—å°ç£çš„äººæƒ…å‘³ã€‚è¨˜å¾—å–æ°´ä¼‘æ¯ã€‚" },
            { title: "å¿ƒæƒ³äº‹æˆ", desc: "å»å»Ÿè£¡æ‹œæ‹œæœƒå¾ˆéˆé©—å–”ï¼é©åˆè²·å½©åˆ¸ã€‚" },
            { title: "æ­¥æ­¥é«˜å‡", desc: "å»çˆ¬è±¡å±±æˆ–ç™»ä¸Š101ï¼Œè¦–é‡è¶Šå¥½é‹æ°£è¶Šå¥½ï¼" }
        ];

        // æš«å­˜ç·¨è¼¯è³‡æ–™ (Adminç”¨)
        let EditData = null;

        // ==========================================
        // 2. æ‡‰ç”¨ç¨‹å¼é‚è¼¯ (Actions)
        // ==========================================
        const Actions = {
            navigate: (view) => {
                AppState.currentView = view;
                Render();
            },
            
            selectDay: (index) => {
                AppState.currentDayIndex = index;
                Render();
            },

            selectDayAndNavigate: (index) => {
                AppState.currentDayIndex = index;
                AppState.currentView = 'itinerary';
                Render();
            },

            handleLogoClick: () => {
                AppState.adminClickCount++;
                if (AppState.adminClickTimer) clearTimeout(AppState.adminClickTimer);

                // é»æ“Š 5 æ¬¡é€²å…¥ Admin
                if (AppState.adminClickCount >= 5) {
                    Actions.navigate('admin');
                    AppState.adminClickCount = 0;
                } else {
                    AppState.adminClickTimer = setTimeout(() => {
                        Actions.navigate('home');
                        AppState.adminClickCount = 0;
                    }, 500);
                }
            },

            openPacket: (index) => {
                if (AppState.luckyDraw.openedIndex !== null) return;
                const random = Math.floor(Math.random() * Fortunes.length);
                AppState.luckyDraw.openedIndex = index;
                AppState.luckyDraw.currentFortune = Fortunes[random];
                Render();
            },

            resetPacket: () => {
                AppState.luckyDraw.openedIndex = null;
                AppState.luckyDraw.currentFortune = null;
                Render();
            },

            // Admin Logic
            initAdmin: () => {
                // æ·±æ‹·è²è³‡æ–™ä»¥ä¾›ç·¨è¼¯
                EditData = JSON.parse(JSON.stringify(TripData));
                Render();
            },

            updateEditData: (path, value) => {
                // è·¯å¾‘è§£æ e.g., 'days.0.theme'
                const keys = path.split('.');
                let current = EditData;
                for(let i=0; i<keys.length-1; i++){
                    current = current[keys[i]];
                }
                current[keys[keys.length-1]] = value;
                // ä¸å³æ™‚é‡ç¹ªï¼Œé¿å…è¼¸å…¥æ¡†å¤±å»ç„¦é»ï¼Œåƒ…æ›´æ–°è³‡æ–™
            },

            addActivity: (dayIndex) => {
                EditData.days[dayIndex].activities.push({
                    time: '00:00', title: 'æ–°æ´»å‹•', description: 'æè¿°...', location: '', icon: 'ğŸ“Œ'
                });
                Render();
            },

            removeActivity: (dayIndex, actIndex) => {
                if(confirm('ç¢ºå®šåˆªé™¤?')) {
                    EditData.days[dayIndex].activities.splice(actIndex, 1);
                    Render();
                }
            },

            addDay: () => {
                EditData.days.push({
                    dayNumber: EditData.days.length + 1,
                    theme: 'æ–°çš„ä¸€å¤©', highlights: 'äº®é»...', imgUrl: 'taiwan', activities: []
                });
                Render();
            },

            removeDay: (dayIndex) => {
                if(confirm('ç¢ºå®šåˆªé™¤æ•´å¤©?')) {
                    EditData.days.splice(dayIndex, 1);
                    // é‡æ–°ç·¨è™Ÿ
                    EditData.days.forEach((d, i) => d.dayNumber = i + 1);
                    Render();
                }
            },

            saveAdmin: () => {
                TripData = JSON.parse(JSON.stringify(EditData));
                alert('å·²å„²å­˜ï¼');
                Render();
            },

            cancelAdmin: () => {
                if(confirm('æ”¾æ£„ä¿®æ”¹?')) {
                    EditData = null;
                    Actions.navigate('home');
                }
            }
        };

        // ==========================================
        // 3. å…ƒä»¶æ¸²æŸ“å‡½æ•¸ (HTML Templates)
        // ==========================================

        const Header = () => `
            <header class="bg-red-900 border-b-4 border-yellow-500 shadow-xl relative overflow-hidden z-20 flex-shrink-0">
                <div class="absolute -top-10 -left-10 w-32 h-32 bg-yellow-500/20 rounded-full blur-xl"></div>
                <div class="absolute top-0 right-0 w-40 h-40 bg-red-600/20 rounded-full blur-2xl"></div>

                <div class="container mx-auto px-4 py-4 flex flex-col md:flex-row justify-between items-center relative z-10">
                    <div class="flex items-center gap-4 mb-4 md:mb-0 select-none">
                        <div onclick="Actions.handleLogoClick()" class="w-14 h-14 rounded-full border-4 border-yellow-400 flex items-center justify-center text-3xl bg-red-800 text-yellow-400 cursor-pointer hover:bg-red-700 active:scale-95 transition-all shadow-lg">â­•</div>
                        <div onclick="Actions.navigate('home')" class="cursor-pointer">
                            <h1 class="text-3xl md:text-4xl font-bold text-yellow-100 font-serif-tc tracking-widest">${TripData.title}</h1>
                        </div>
                    </div>
                    <nav class="flex gap-8 text-xl md:text-2xl font-bold text-yellow-100/90">
                        <button onclick="Actions.navigate('itinerary')" class="hover:text-yellow-400 flex items-center gap-2 transition-colors py-2">
                            <span class="text-yellow-500 text-2xl">ğŸ“…</span> è¡Œç¨‹
                        </button>
                        <button onclick="Actions.navigate('preparation')" class="hover:text-yellow-400 flex items-center gap-2 transition-colors py-2">
                            <span class="text-yellow-500 text-2xl">ğŸ’¡</span> è²¼å£«
                        </button>
                    </nav>
                </div>
            </header>
        `;

        const Hero = () => {
            const { openedIndex, currentFortune } = AppState.luckyDraw;
            
            // ç´…åŒ…åˆ—è¡¨ HTML
            const packetsHtml = [0, 1, 2].map(index => {
                const isOpened = openedIndex !== null;
                const isThis = openedIndex === index;
                let classes = "relative w-36 h-52 md:w-48 md:h-64 bg-red-700 rounded-3xl shadow-xl border-b-[12px] border-red-900 transition-all duration-300 flex flex-col items-center justify-center overflow-hidden group";
                
                if (isOpened && !isThis) classes += " grayscale opacity-50 cursor-not-allowed";
                else if (!isOpened) classes += " hover:-translate-y-4 cursor-pointer";

                return `
                <button onclick="Actions.openPacket(${index})" class="${classes}" ${isOpened ? 'disabled' : ''}>
                    <div class="absolute inset-0 flex flex-col items-center justify-center bg-gradient-to-br from-red-600 to-red-800">
                         <div class="w-20 h-20 md:w-28 md:h-28 rounded-full border-[6px] border-yellow-400 flex items-center justify-center bg-red-700 shadow-inner group-hover:scale-110 transition-transform">
                            <span class="text-5xl md:text-7xl text-yellow-400 font-serif-tc font-bold">ç¦</span>
                         </div>
                         <div class="absolute bottom-0 w-full h-10 md:h-14 bg-yellow-500/20 rounded-t-[50%]"></div>
                    </div>
                </button>
                `;
            }).join('');

            // é‹å‹¢çµæœ HTML
            const fortuneHtml = currentFortune ? `
                <div class="border-[6px] border-dashed border-yellow-400 bg-yellow-50 rounded-3xl p-10 md:p-12 text-center animate-fadeIn mx-4 md:mx-12 shadow-inner mt-8">
                    <div class="text-4xl md:text-6xl mb-8 flex justify-center items-center gap-6">
                        <span>ğŸŠ</span>
                        <span class="font-bold text-red-900 font-serif-tc">${currentFortune.title}</span>
                        <span>ğŸŠ</span>
                    </div>
                    <p class="text-slate-800 text-3xl md:text-4xl mb-8 font-bold leading-relaxed">${currentFortune.desc}</p>
                    <button onclick="Actions.resetPacket()" class="px-8 py-3 bg-red-100 hover:bg-red-200 text-red-800 rounded-xl text-2xl font-bold mt-4 border border-red-300 shadow-sm">
                        å†æŠ½ä¸€æ¬¡
                    </button>
                </div>
            ` : '';

            // è¡Œç¨‹é è¦½å¡ç‰‡
            const dayCards = TripData.days.map((day, idx) => `
                <button onclick="Actions.selectDayAndNavigate(${idx})" class="bg-red-900/80 border-2 border-yellow-500/30 hover:bg-red-800 hover:border-yellow-400 p-8 rounded-2xl text-left transition-all group shadow-lg transform hover:-translate-y-1">
                    <div class="flex items-center justify-between mb-2">
                        <div class="text-yellow-400 text-xl font-bold uppercase tracking-widest bg-red-950/50 px-3 py-1 rounded-lg border border-yellow-500/20">Day ${day.dayNumber}</div>
                        <div class="text-3xl group-hover:scale-125 transition-transform">ğŸ‘‰</div>
                    </div>
                    <div class="text-white text-3xl font-bold group-hover:text-yellow-200 mt-2 font-serif-tc leading-relaxed">${day.theme}</div>
                </button>
            `).join('');

            return `
                <div class="relative bg-gradient-to-b from-red-900/50 to-transparent p-6 md:p-12 text-center border-b border-white/10">
                    <div class="max-w-4xl mx-auto backdrop-blur-sm bg-black/30 p-8 md:p-12 rounded-3xl border border-yellow-500/30 shadow-2xl">
                        <h2 class="text-5xl md:text-6xl font-bold text-yellow-400 font-serif-tc mb-6 drop-shadow-lg leading-tight">æ­¡è¿çˆ¸åª½ä¾†å°ç£ï¼</h2>
                        <p class="text-2xl md:text-3xl text-white mb-10 font-bold leading-relaxed">åƒå¥½ä½å¥½ï¼ŒHuat Ah! <br><span class="inline-block animate-bounce mt-4 text-5xl">ğŸ§§ ğŸ² ğŸ</span></p>
                        <button onclick="Actions.navigate('itinerary')" class="bg-yellow-500 hover:bg-yellow-400 text-red-900 text-3xl font-bold py-6 px-16 rounded-full shadow-xl transform transition hover:scale-105 flex items-center gap-4 mx-auto border-4 border-white/20">
                            <span class="text-4xl">ğŸ“…</span> æŸ¥çœ‹æ¯æ—¥è¡Œç¨‹
                        </button>
                    </div>
                </div>
                
                <!-- Lucky Draw -->
                <div class="max-w-5xl mx-auto mt-12 p-8 md:p-12 bg-white rounded-[2.5rem] shadow-2xl relative overflow-hidden mb-12">
                    <div class="absolute top-0 left-0 w-full h-6 bg-gradient-to-r from-yellow-300 via-red-500 to-yellow-300"></div>
                    <div class="text-center mb-12">
                        <h3 class="text-4xl md:text-5xl font-bold text-red-900 flex items-center justify-center gap-4 font-serif-tc"><span class="text-5xl">ğŸ®</span> æ¯æ—¥å¥½é‹ç´…åŒ…</h3>
                        <p class="text-slate-600 text-2xl mt-4 font-bold">é»æ“Šç´…åŒ…ï¼Œçœ‹çœ‹ä»Šå¤©çš„é‹æ°£ï¼</p>
                    </div>
                    <div class="flex justify-center gap-8 md:gap-16 mb-4 flex-wrap">${packetsHtml}</div>
                    ${fortuneHtml}
                </div>

                <!-- Preview Grid -->
                <div class="container mx-auto px-4 mt-12 pb-24">
                    <div class="flex items-center gap-4 mb-6 justify-center md:justify-start">
                        <div class="h-10 w-2 bg-yellow-400 rounded-full"></div>
                        <h3 class="text-3xl font-bold text-yellow-100 font-serif-tc">ğŸ—“ï¸ è¡Œç¨‹é è¦½ (é»æ“ŠæŸ¥çœ‹)</h3>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">${dayCards}</div>
                </div>
            `;
        };

        const Preparation = () => `
            <div class="container mx-auto max-w-6xl p-4 md:p-8 space-y-8 pb-32">
                <div class="text-center mb-8">
                    <h2 class="text-4xl md:text-5xl font-bold text-red-100 font-serif-tc drop-shadow-md">éŠå°é‡è¦è²¼å£«</h2>
                    <p class="text-2xl text-yellow-200 mt-4">ç°¡å–®å¥½è¨˜ï¼Œé–‹å¿ƒå‡ºéŠï¼</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8">
                    <div class="bg-white rounded-3xl p-8 border-l-8 border-red-600 shadow-xl flex items-start gap-6">
                        <div class="text-6xl">ğŸ›‚</div>
                        <div><h3 class="text-3xl font-bold text-red-900 mb-3">è­‰ä»¶è¦å¸¶é½Š</h3><p class="text-xl text-slate-800 leading-relaxed font-bold">1. è­·ç…§ (6å€‹æœˆæœ‰æ•ˆæœŸ)<br>2. å…¥å¢ƒå¡ (ä¸Šç¶²å¡«å¥½)<br>3. æ©Ÿç¥¨ & é…’åº—è¨‚å–®</p></div>
                    </div>
                    <div class="bg-white rounded-3xl p-8 border-l-8 border-blue-500 shadow-xl flex items-start gap-6">
                        <div class="text-6xl">ğŸ§¥</div>
                        <div><h3 class="text-3xl font-bold text-blue-900 mb-3">å¤©æ°£èˆ‡ç©¿è‘—</h3><p class="text-xl text-slate-800 leading-relaxed font-bold">éå¹´å°åŒ—æœƒå†· (15Â°C)ï¼<br>è«‹å¸¶<span class="text-red-600">å¤–å¥—</span>å’Œ<span class="text-red-600">å¥½èµ°çš„é‹</span>ã€‚<br>æ´‹è”¥å¼ç©¿æ³•æœ€ä¿æš–ã€‚</p></div>
                    </div>
                    <div class="bg-white rounded-3xl p-8 border-l-8 border-yellow-500 shadow-xl flex items-start gap-6">
                        <div class="text-6xl">ğŸ’°</div>
                        <div><h3 class="text-3xl font-bold text-yellow-700 mb-3">éŒ¢å¹£åŒ¯ç‡</h3><p class="text-xl text-slate-800 leading-relaxed font-bold">1 é¦¬å¹£ â‰ˆ 7 å°å¹£<br>å¸¶ç¾é‡‘å»æ©Ÿå ´æ›ï¼Œæˆ–ç”¨ATMææ¬¾ã€‚<br>å¤§å•†å ´å¯åˆ·å¡ã€‚</p></div>
                    </div>
                    <div class="bg-white rounded-3xl p-8 border-l-8 border-green-600 shadow-xl flex items-start gap-6">
                        <div class="text-6xl">ğŸ’³</div>
                        <div><h3 class="text-3xl font-bold text-green-800 mb-3">æ‚ éŠå¡ (EasyCard)</h3><p class="text-xl text-slate-800 leading-relaxed font-bold">äººæ‰‹ä¸€å¼µï¼å¿…è²·ï¼<br>æ­æ·é‹ã€å…¬è»Šã€è²·æ±è¥¿éƒ½èƒ½ç”¨ã€‚<br>7-11 å°±å¯ä»¥è²·åˆ°ã€‚</p></div>
                    </div>
                    <div class="bg-white rounded-3xl p-8 border-l-8 border-slate-600 shadow-xl flex items-start gap-6">
                        <div class="text-6xl">ğŸ”Œ</div>
                        <div><h3 class="text-3xl font-bold text-slate-800 mb-3">æ’é ­é›»å£“</h3><p class="text-xl text-slate-800 leading-relaxed font-bold">å°ç£æ˜¯ 110V (æ‰å­”)ã€‚<br>è¨˜å¾—å¸¶<span class="text-red-600">åœ‹éš›è½‰æ¥é ­</span>ï¼<br>æ‰‹æ©Ÿå……é›»å™¨é€šå¸¸é€šç”¨ã€‚</p></div>
                    </div>
                    <div class="bg-white rounded-3xl p-8 border-l-8 border-red-800 shadow-xl flex items-start gap-6">
                        <div class="text-6xl">ğŸš¨</div>
                        <div><h3 class="text-3xl font-bold text-red-900 mb-3">ç·Šæ€¥é›»è©±</h3><p class="text-xl text-slate-800 leading-relaxed font-bold">å ±è­¦ï¼š110<br>æ•‘è­·è»Šï¼š119<br>å°ç£æ²»å®‰å¾ˆå¥½ï¼Œæ”¾å¿ƒç©ï¼</p></div>
                    </div>
                </div>
                <div class="text-center pt-12">
                    <p class="text-2xl text-yellow-200 font-serif-tc">ç¥ çˆ¸çˆ¸åª½åª½ èº«é«”å¥åº·ï¼Œæ—…é€”æ„‰å¿«ï¼</p>
                </div>
            </div>
        `;

        const Itinerary = () => {
            const currentDay = TripData.days[AppState.currentDayIndex];
            
            // Tabs
            const tabsHtml = TripData.days.map((day, index) => {
                const isActive = index === AppState.currentDayIndex;
                const activeClass = isActive 
                    ? "bg-yellow-500 text-red-900 scale-110" 
                    : "bg-red-900 text-yellow-100";
                return `
                <button onclick="Actions.selectDay(${index})" class="${activeClass} flex-shrink-0 px-8 py-4 rounded-2xl text-2xl font-bold whitespace-nowrap transition-all shadow-lg border-2 border-yellow-500/50">
                    Day ${day.dayNumber}
                </button>`;
            }).join('');

            // Activities
            const activitiesHtml = currentDay.activities.map((act, idx) => `
                <div class="relative flex gap-6 mb-10 last:mb-0 group">
                    <div class="relative z-10 w-14 h-14 flex-shrink-0 rounded-full bg-white border-4 border-red-500 text-2xl flex items-center justify-center shadow-md group-hover:scale-110 transition-transform">
                        ${act.icon}
                    </div>
                    <div class="flex-1 pt-1">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="text-red-700 font-bold text-xl bg-red-100 px-4 py-1 rounded-full border border-red-200 shadow-sm">${act.time}</span>
                        </div>
                        <h4 class="font-bold text-slate-900 text-3xl leading-tight mb-2">${act.title}</h4>
                        <p class="text-slate-700 text-xl md:text-2xl font-medium leading-relaxed">${act.description}</p>
                    </div>
                </div>
            `).join('');

            // Map Markers
            const markersHtml = currentDay.activities.map((act, idx) => {
                const top = 20 + ((idx * 13) % 60);
                const left = 50 + ((idx % 2 === 0 ? 1 : -1) * 15);
                return `
                <div class="absolute transform -translate-x-1/2 -translate-y-1/2 flex flex-col items-center hover:z-50 cursor-pointer group/marker transition-all duration-500" style="top: ${top}%; left: ${left}%;">
                    <div class="bg-red-700 text-white text-lg md:text-xl font-bold px-4 py-2 rounded-lg shadow-xl mb-2 whitespace-nowrap opacity-100 border-2 border-white z-20">
                        ${act.title}
                    </div>
                    <div class="w-8 h-8 rounded-full bg-red-600 border-4 border-white shadow-lg animate-bounce flex items-center justify-center text-sm font-bold text-white z-10" style="animation-delay: ${idx * 200}ms">
                        ${idx + 1}
                    </div>
                </div>`;
            }).join('');

            return `
            <div class="flex-1 flex flex-col container mx-auto px-4 py-6 h-full min-h-0">
                <div class="flex gap-4 mb-6 overflow-x-auto pb-4 scrollbar-hide flex-shrink-0">${tabsHtml}</div>
                <div class="flex-1 min-h-0 pb-6">
                    <div class="h-full flex flex-col md:flex-row bg-white rounded-2xl overflow-hidden shadow-2xl">
                        <!-- Left Panel -->
                        <div class="w-full md:w-1/2 lg:w-[450px] flex flex-col bg-slate-50 border-r border-slate-200 overflow-hidden h-1/2 md:h-full">
                            <div class="relative h-48 md:h-56 bg-gray-200 flex-shrink-0">
                                <img src="https://picsum.photos/seed/${currentDay.imgUrl}/800/600" class="w-full h-full object-cover" alt="Day thumbnail" />
                                <div class="absolute inset-0 bg-gradient-to-t from-black/90 to-transparent flex items-end p-6">
                                    <div><h3 class="text-yellow-400 text-3xl md:text-4xl font-bold font-serif-tc shadow-black drop-shadow-lg leading-tight">Day ${currentDay.dayNumber}<br><span class="text-white">${currentDay.theme}</span></h3></div>
                                </div>
                            </div>
                            <div class="flex-1 overflow-y-auto p-4 md:p-6 space-y-8">
                                <div class="bg-red-50 p-6 rounded-2xl border-2 border-red-200 text-red-900 shadow-sm">
                                    <div class="flex items-center gap-2 mb-2"><span class="text-2xl">ğŸ“Œ</span><span class="font-bold text-xl">ä»Šæ—¥é‡é»ï¼š</span></div>
                                    <p class="text-xl md:text-2xl font-medium leading-relaxed">${currentDay.highlights}</p>
                                </div>
                                <div class="relative pl-3 md:pl-4">
                                    <div class="absolute left-[26px] top-4 bottom-4 w-1 bg-red-200 rounded-full"></div>
                                    ${activitiesHtml}
                                </div>
                                <div class="text-center pt-8 pb-4"><span class="text-slate-400 text-lg">--- Day ${currentDay.dayNumber} çµæŸ ---</span></div>
                            </div>
                        </div>
                        <!-- Right Panel (Map) -->
                        <div class="flex-1 bg-blue-50 relative overflow-hidden group h-96 md:h-auto border-t-4 md:border-t-0 md:border-l-4 border-slate-200">
                            <svg class="absolute inset-0 w-full h-full pointer-events-none" viewBox="0 0 400 600" preserveAspectRatio="xMidYMid meet">
                                <path d="M200,50 Q230,60 250,100 Q280,180 260,300 Q240,450 200,550 Q160,450 140,300 Q120,150 160,80 Q180,50 200,50 Z" fill="#dbeafe" stroke="#3b82f6" stroke-width="4" />
                            </svg>
                            ${markersHtml}
                        </div>
                    </div>
                </div>
            </div>`;
        };

        const Admin = () => {
            if (!EditData) Actions.initAdmin();
            
            const daysHtml = EditData.days.map((day, dayIndex) => {
                const activitiesInputs = day.activities.map((act, actIndex) => `
                    <div class="flex flex-col md:flex-row gap-4 items-start p-4 bg-slate-50 rounded-xl group hover:bg-yellow-50 transition-colors relative border border-slate-100">
                        <button onclick="Actions.removeActivity(${dayIndex}, ${actIndex})" class="absolute top-2 right-2 text-slate-300 hover:text-red-500 transition-colors text-2xl font-bold px-2">âœ•</button>
                        <div class="flex gap-3 w-full md:w-40 flex-shrink-0">
                            <div class="w-1/2"><input value="${act.time}" onchange="Actions.updateEditData('days.${dayIndex}.activities.${actIndex}.time', this.value)" class="w-full p-2 bg-white text-black border border-slate-200 rounded text-center text-lg font-bold" /></div>
                            <div class="w-1/2"><input value="${act.icon}" onchange="Actions.updateEditData('days.${dayIndex}.activities.${actIndex}.icon', this.value)" class="w-full p-2 bg-white text-black border border-slate-200 rounded text-center text-2xl" /></div>
                        </div>
                        <div class="flex-1 w-full space-y-3">
                            <input value="${act.title}" onchange="Actions.updateEditData('days.${dayIndex}.activities.${actIndex}.title', this.value)" class="w-full p-2 bg-transparent text-black text-xl font-bold border-b border-dashed border-slate-300 focus:border-yellow-500 outline-none" />
                            <textarea rows="2" onchange="Actions.updateEditData('days.${dayIndex}.activities.${actIndex}.description', this.value)" class="w-full p-2 bg-transparent text-black text-lg border-b border-dashed border-slate-300 focus:border-yellow-500 outline-none">${act.description}</textarea>
                        </div>
                    </div>
                `).join('');

                return `
                <div class="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden relative shadow-sm mb-10">
                    <button onclick="Actions.removeDay(${dayIndex})" class="absolute top-4 right-4 z-10 bg-red-100 hover:bg-red-600 text-red-600 hover:text-white px-4 py-2 rounded-lg text-sm font-bold transition-colors border border-red-200">ğŸ—‘ï¸ åˆªé™¤ Day ${day.dayNumber}</button>
                    <div class="bg-slate-100 p-6 border-b border-slate-200 flex flex-col md:flex-row gap-6 items-start md:items-center pr-32">
                        <div class="bg-slate-800 text-white px-4 py-2 rounded-lg font-bold whitespace-nowrap text-xl">Day ${day.dayNumber}</div>
                        <div class="flex-1 w-full">
                            <label class="text-sm font-bold text-slate-500 uppercase">ä¸»é¡Œ</label>
                            <input value="${day.theme}" onchange="Actions.updateEditData('days.${dayIndex}.theme', this.value)" class="w-full font-bold text-2xl text-black bg-transparent border-b border-slate-300 focus:border-yellow-500 outline-none py-1" />
                        </div>
                        <div class="flex-1 w-full">
                            <label class="text-sm font-bold text-slate-500 uppercase">åœ–ç‰‡é—œéµå­—</label>
                            <input value="${day.imgUrl}" onchange="Actions.updateEditData('days.${dayIndex}.imgUrl', this.value)" class="w-full text-lg text-black bg-transparent border-b border-slate-300 focus:border-yellow-500 outline-none py-1" />
                        </div>
                    </div>
                    <div class="p-6 space-y-6">
                        <div>
                            <label class="block text-sm font-bold text-slate-500 uppercase mb-2">ä»Šæ—¥äº®é»</label>
                            <textarea rows="2" onchange="Actions.updateEditData('days.${dayIndex}.highlights', this.value)" class="w-full p-3 text-black text-xl border border-slate-200 rounded focus:ring-1 focus:ring-yellow-500 outline-none">${day.highlights}</textarea>
                        </div>
                        <div class="space-y-6 pl-4 border-l-4 border-yellow-500/20">
                            ${activitiesInputs}
                            <button onclick="Actions.addActivity(${dayIndex})" class="w-full py-4 border-2 border-dashed border-slate-300 text-slate-400 rounded-xl hover:border-yellow-400 hover:text-yellow-600 font-bold text-xl transition-colors">+ æ–°å¢æ´»å‹•</button>
                        </div>
                    </div>
                </div>`;
            }).join('');

            return `
            <div class="container mx-auto p-4 md:p-8 pb-24 max-w-5xl">
                <div class="bg-white rounded-xl shadow-2xl overflow-hidden border border-yellow-500/30">
                    <div class="bg-slate-800 p-6 flex justify-between items-center border-b border-slate-700 sticky top-0 z-20">
                        <div><h2 class="text-3xl font-bold text-yellow-400 font-serif-tc">ğŸ”§ è¡Œç¨‹ç·¨è¼¯æ¨¡å¼</h2></div>
                        <div class="flex gap-4">
                            <button onclick="Actions.cancelAdmin()" class="px-6 py-3 rounded-lg text-slate-300 hover:text-white font-bold hover:bg-slate-700 transition-colors text-lg">å–æ¶ˆ</button>
                            <button onclick="Actions.saveAdmin()" class="px-8 py-3 rounded-lg bg-yellow-500 hover:bg-yellow-400 text-slate-900 font-bold shadow-lg transform active:scale-95 transition-all flex items-center gap-2 text-lg">ğŸ’¾ å„²å­˜</button>
                        </div>
                    </div>
                    <div class="p-6 bg-slate-50 overflow-y-auto max-h-[80vh]">
                        <div class="mb-8 p-6 bg-white rounded-lg border border-slate-200 shadow-sm">
                            <label class="block text-slate-700 font-bold mb-2 text-xl">æ—…ç¨‹æ¨™é¡Œ</label>
                            <input value="${EditData.title}" onchange="Actions.updateEditData('title', this.value)" class="w-full text-2xl font-bold text-black p-4 border border-slate-300 rounded focus:ring-2 focus:ring-yellow-500 outline-none" />
                        </div>
                        <div class="space-y-10">${daysHtml}</div>
                        <div class="mt-10 text-center">
                             <button onclick="Actions.addDay()" class="px-8 py-4 bg-slate-200 hover:bg-slate-300 text-slate-800 rounded-xl font-bold shadow-sm border border-slate-300 text-xl">+ æ–°å¢ä¸€å¤©</button>
                        </div>
                    </div>
                </div>
            </div>
            `;
        };

        // ==========================================
        // 4. ä¸»æ¸²æŸ“å¾ªç’° (Render Loop)
        // ==========================================
        function Render() {
            const app = document.getElementById('app');
            let content = '';
            
            // Header is always present
            content += Header();
            
            // Main Content Area
            content += '<main class="flex-1 overflow-y-auto scrollbar-hide flex flex-col">';
            
            switch(AppState.currentView) {
                case 'home':
                    content += Hero();
                    break;
                case 'itinerary':
                    content += Itinerary();
                    break;
                case 'preparation':
                    content += Preparation();
                    break;
                case 'admin':
                    content += Admin();
                    break;
            }
            
            content += '</main>';
            
            app.innerHTML = content;
        }

        // å•Ÿå‹•æ‡‰ç”¨
        Render();

    </script>
</body>
</html>
